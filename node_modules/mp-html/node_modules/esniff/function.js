"use strict";

var ensureString = require("type/string/ensure")
  , isValue      = require("type/value/is")
  , esniff       = require("./");

module.exports = function (name/*, options*/) {
	var options = Object(arguments[1])
	  , asProperty = options.asProperty
	  , asPlain = isValue(options.asPlain) ? options.asPlain : true;
	var length, names;
	name = ensureString(name);
	names = name.split(".").map(function (prop) {
		prop = prop.trim();
		if (!prop) throw new TypeError(name + " is not valid function name");
		return prop;
	});
	length = names.length;
	return function (code) {
		code = ensureString(code);
		return esniff(code, function (emitter) {
			emitter.on("trigger:" + names[0]